<div class="edit-profile-container">
    <div class="edit-profile-header">
        <h1>Edit Profile</h1>
        <p>Update your profile information and preferences</p>
    </div>
    
    <div class="edit-profile-content">
        <div class="profile-section">
            <h2>Basic Information</h2>
            <form method="POST" action="/edit-profile" id="profileForm" class="profile-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="firstName">First Name</label>
                        <input type="text" 
                               id="firstName" 
                               name="firstName" 
                               class="form-control" 
                               value="<%= formData.firstName || user.firstName %>"
                               required>
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">Last Name</label>
                        <input type="text" 
                               id="lastName" 
                               name="lastName" 
                               class="form-control" 
                               value="<%= formData.lastName || user.lastName %>"
                               required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" 
                           id="email" 
                           name="email" 
                           class="form-control" 
                           value="<%= formData.email || user.email %>"
                           required>
                </div>
                
                <div class="form-group">
                    <label for="bio">Bio</label>
                    <textarea id="bio" 
                              name="bio" 
                              class="form-control" 
                              rows="4"
                              maxlength="1000"><%= formData.bio || user.bio || '' %></textarea>
                    <div class="char-counter">
                        <span id="bioCounter"><%= (formData.bio || user.bio || '').length %></span>/1000
                    </div>
                </div>
                
                <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" 
                               name="emailPublic" 
                               id="emailPublic"
                               <%= (formData.emailPublic !== undefined ? formData.emailPublic : user.emailPublic) ? 'checked' : '' %>>
                        <span class="checkmark"></span>
                        Make my email address public
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                    <a href="/profile/<%= user.id %>" class="btn btn-outline">Cancel</a>
                </div>
            </form>
        </div>
        
        <div class="profile-section">
            <h2>Profile Picture</h2>
            <div class="avatar-upload-section">
                <div class="current-avatar">
                    <img src="<%= user.avatar || '/images/default-avatar.png' %>" 
                         alt="Current avatar" 
                         class="current-avatar-img">
                    <p class="avatar-info">Current profile picture</p>
                </div>
                
                <div class="avatar-upload">
                    <button class="btn btn-outline" onclick="document.getElementById('avatarInput').click()">
                        üì∑ Upload New Picture
                    </button>
                    <input type="file" 
                           id="avatarInput" 
                           accept="image/*" 
                           style="display: none;" 
                           onchange="uploadAvatar(this)">
                    <p class="upload-help">
                        JPG, GIF or PNG. Max size of 5MB.
                    </p>
                </div>
            </div>
        </div>
        
        <div class="profile-section">
            <h2>Preferences</h2>
            <form method="POST" action="/update-preferences" id="preferencesForm" class="preferences-form">
                <div class="form-group">
                    <label>Theme</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="theme" value="light" 
                                   <%= (user.preferences && user.preferences.theme === 'light') ? 'checked' : '' %>>
                            <span class="radio-checkmark"></span>
                            Light
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="theme" value="dark" 
                                   <%= (user.preferences && user.preferences.theme === 'dark') ? 'checked' : '' %>>
                            <span class="radio-checkmark"></span>
                            Dark
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="theme" value="auto" 
                                   <%= (!user.preferences || !user.preferences.theme || user.preferences.theme === 'auto') ? 'checked' : '' %>>
                            <span class="radio-checkmark"></span>
                            Auto (system preference)
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Language</label>
                    <select name="language" class="form-control">
                        <option value="en" <%= (user.preferences && user.preferences.language === 'en') ? 'selected' : '' %>>
                            English
                        </option>
                        <option value="ru" <%= (user.preferences && user.preferences.language === 'ru') ? 'selected' : '' %>>
                            –†—É—Å—Å–∫–∏–π
                        </option>
                        <option value="es" <%= (user.preferences && user.preferences.language === 'es') ? 'selected' : '' %>>
                            Espa√±ol
                        </option>
                    </select>
                </div>
                
                <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" 
                               name="emailNotifications" 
                               id="emailNotifications"
                               <%= (user.preferences && user.preferences.emailNotifications !== false) ? 'checked' : '' %>>
                        <span class="checkmark"></span>
                        Email notifications
                    </label>
                </div>
                
                <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" 
                               name="pushNotifications" 
                               id="pushNotifications"
                               <%= (user.preferences && user.preferences.pushNotifications !== false) ? 'checked' : '' %>>
                        <span class="checkmark"></span>
                        Push notifications
                    </label>
                </div>
                
                <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" 
                               name="browserNotifications" 
                               id="browserNotifications"
                               <%= (user.preferences && user.preferences.browserNotifications) ? 'checked' : '' %>>
                        <span class="checkmark"></span>
                        Browser notifications
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">Save Preferences</button>
                </div>
            </form>
        </div>
        
        <div class="profile-section">
            <h2>Account</h2>
            <div class="account-actions">
                <div class="action-item">
                    <h3>Change Password</h3>
                    <p>Update your password to keep your account secure</p>
                    <button class="btn btn-outline" onclick="showChangePasswordForm()">
                        Change Password
                    </button>
                </div>
                
                <div class="action-item">
                    <h3>Download My Data</h3>
                    <p>Download all your data from Minis</p>
                    <button class="btn btn-outline" onclick="downloadMyData()">
                        Download Data
                    </button>
                </div>
                
                <div class="action-item danger">
                    <h3>Delete Account</h3>
                    <p>Permanently delete your account and all your data</p>
                    <button class="btn btn-danger" onclick="showDeleteAccountForm()">
                        Delete Account
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è -->
<div id="changePasswordModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Change Password</h3>
            <button class="close-btn" onclick="closeModal('changePasswordModal')">&times;</button>
        </div>
        <form onsubmit="changePassword(event)">
            <div class="form-group">
                <label for="currentPassword">Current Password</label>
                <input type="password" id="currentPassword" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="newPassword">New Password</label>
                <input type="password" id="newPassword" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="confirmNewPassword">Confirm New Password</label>
                <input type="password" id="confirmNewPassword" class="form-control" required>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">Change Password</button>
                <button type="button" class="btn btn-outline" onclick="closeModal('changePasswordModal')">
                    Cancel
                </button>
            </div>
        </form>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ -->
<div id="deleteAccountModal" class="modal" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Delete Account</h3>
            <button class="close-btn" onclick="closeModal('deleteAccountModal')">&times;</button>
        </div>
        <div class="modal-body">
            <p>Are you sure you want to delete your account? This action cannot be undone.</p>
            <p><strong>All your data will be permanently deleted:</strong></p>
            <ul>
                <li>Your profile information</li>
                <li>All your messages</li>
                <li>Your friends and connections</li>
                <li>Your notifications</li>
                <li>Your applications</li>
            </ul>
            <form onsubmit="deleteAccount(event)">
                <div class="form-group">
                    <label for="deleteConfirm">Type "DELETE" to confirm</label>
                    <input type="text" id="deleteConfirm" class="form-control" required>
                </div>
                <div class="form-group checkbox-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="deleteAcknowledge" required>
                        <span class="checkmark"></span>
                        I understand that this action cannot be undone
                    </label>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-danger">Delete My Account</button>
                    <button type="button" class="btn btn-outline" onclick="closeModal('deleteAccountModal')">
                        Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>