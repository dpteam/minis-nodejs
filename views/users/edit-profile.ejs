<div class="vk-content-box">
    <h2><i class="fas fa-edit"></i> Редактирование профиля</h2>
    
    <%if (messages.success) { %>
    <div class="vk-alert vk-alert-success">
        <i class="fas fa-check-circle"></i> <%=messages.success%>
    </div>
    <% } %>
    <%if (messages.error) { %>
    <div class="vk-alert vk-alert-error">
        <i class="fas fa-exclamation-circle"></i> <%=messages.error%>
    </div>
    <% } %>
    <%if (errors && errors.length>0) { %>
    <div class="vk-alert vk-alert-error">
        <i class="fas fa-exclamation-triangle"></i>
        <ul>
            <%errors.forEach(error=> { %>
                <li><%=error.msg%></li>
            <% }); %>
        </ul>
    </div>
    <% } %>

    <form action="/edit-profile" method="POST" enctype="multipart/form-data">
        <div class="vk-form-group">
            <label for="firstName"><i class="fas fa-user"></i> Имя:</label>
            <input type="text" id="firstName" name="firstName" class="vk-form-control" value="<%= user.firstName %>" required>
        </div>
        
        <div class="vk-form-group">
            <label for="lastName"><i class="fas fa-user"></i> Фамилия:</label>
            <input type="text" id="lastName" name="lastName" class="vk-form-control" value="<%= user.lastName %>" required>
        </div>
        
        <div class="vk-form-group">
            <label for="email"><i class="fas fa-envelope"></i> Email:</label>
            <input type="email" id="email" name="email" class="vk-form-control" value="<%= user.email %>" required>
        </div>
        
        <div class="vk-form-group">
            <label for="bio"><i class="fas fa-info-circle"></i> О себе:</label>
            <textarea id="bio" name="bio" class="vk-form-control" rows="4"><%= user.bio || '' %></textarea>
        </div>
        
        <div class="vk-form-group">
            <label for="avatar"><i class="fas fa-image"></i> Аватар:</label>
            <input type="file" id="avatar" name="avatar" class="vk-form-control" accept="image/*">
            <small>Оставьте пустым, чтобы сохранить текущий аватар</small>
        </div>
        
        <% if (user.avatar) { %>
        <div class="vk-form-group">
            <label>
                <input type="checkbox" name="removeAvatar"> Удалить текущий аватар
            </label>
        </div>
        <% } %>
        
        <div class="vk-form-group">
            <label for="currentPassword"><i class="fas fa-lock"></i> Текущий пароль:</label>
            <input type="password" id="currentPassword" name="currentPassword" class="vk-form-control">
            <small>Заполните только если хотите изменить пароль</small>
        </div>
        
        <div class="vk-form-group">
            <label for="newPassword"><i class="fas fa-lock"></i> Новый пароль:</label>
            <input type="password" id="newPassword" name="newPassword" class="vk-form-control">
        </div>
        
        <div class="vk-form-group">
            <label for="confirmPassword"><i class="fas fa-lock"></i> Подтвердите новый пароль:</label>
            <input type="password" id="confirmPassword" name="confirmPassword" class="vk-form-control">
        </div>
        
        <div class="vk-form-group">
            <label for="privacy"><i class="fas fa-eye"></i> Видимость профиля:</label>
            <select id="privacy" name="privacy" class="vk-form-control">
                <option value="public" <%= user.privacy === 'public' ? 'selected' : '' %>>Публичный</option>
                <option value="friends" <%= user.privacy === 'friends' ? 'selected' : '' %>>Только для друзей</option>
                <option value="private" <%= user.privacy === 'private' ? 'selected' : '' %>>Приватный</option>
            </select>
        </div>
        
        <div class="vk-form-group">
            <label>
                <input type="checkbox" name="emailNotifications" <%= user.emailNotifications ? 'checked' : '' %>>
                Получать email-уведомления
            </label>
        </div>
        
        <div class="vk-form-group">
            <label>
                <input type="checkbox" name="showEmail" <%= user.showEmail ? 'checked' : '' %>>
                Показывать email в профиле
            </label>
        </div>
        
        <button type="submit" class="vk-btn">
            <i class="fas fa-save"></i> Сохранить изменения
        </button>
        
        <a href="/profile" class="vk-btn vk-btn-secondary">
            <i class="fas fa-times"></i> Отмена
        </a>
    </form>
</div>